var $=$||function(n,t){t||(t=document);var i=arguments;return i.length===0?t:typeof arguments[0]=="function"?(t.addEventListener("DOMContentLoaded",function(n){i[0].call(this,n)}),t):t.querySelector(n)},Bob,getExpression;(function(){Element.prototype._addEventListener=Element.prototype.addEventListener;Element.prototype.addEventListener=function(n,t,i){i==undefined&&(i=!1);this._addEventListener(n,t,i);this.eventListenerList||(this.eventListenerList={});this.eventListenerList[n]||(this.eventListenerList[n]=[]);this.eventListenerList[n].push({listener:t,useCapture:i})};Element.prototype.getEventListeners=function(n){return(this.eventListenerList||(this.eventListenerList={}),n==undefined)?this.eventListenerList:this.eventListenerList[n]};Element.prototype.clearEventListeners=function(n){var u,t,i,r;if(this.eventListenerList||(this.eventListenerList={}),n==undefined){for(u in this.getEventListeners())this.clearEventListeners(u);return}if(t=this.getEventListeners(n),t!=undefined)for(i=t.length-1;i>=0;--i)r=t[i],this.removeEventListener(n,r.listener,r.useCapture)};Element.prototype._removeEventListener=Element.prototype.removeEventListener;Element.prototype.removeEventListener=function(n,t,i){i==undefined&&(i=!1);this._removeEventListener(n,t,i);this.eventListenerList||(this.eventListenerList={});this.eventListenerList[n]||(this.eventListenerList[n]=[]);for(var r=0;r<this.eventListenerList[n].length;r++)if(this.eventListenerList[n][r].listener==t,this.eventListenerList[n][r].useCapture==i){this.eventListenerList[n].splice(r,1);break}this.eventListenerList[n].length==0&&delete this.eventListenerList[n]}})();Bob=Bob||{};Bob.Guid={newGuid:function(n,t){for(t=n="";n++<36;t+=n*51&52?(n^15?8^Math.random()*(n^20?16:4):4).toString(16):"-");return t}};getExpression=function(n){var i=n.split(".").first(),r=i.match(/\((.*?)\)/),t;return r&&(i=i.replace(r[0],"")),t=i.replace(/[()]/g,""),t=t.replace(/\[(\w+)\]/g,".$1"),t=t.replace(/^\./,""),{prop:t,args:r,isFn:r===null?!1:!0}};Bob.serializeForm=function(n){n||(n=this);var r,i,f,t,u;for(r={},u=n.elements,i=0,f=u.length;i<f;i++)t=u[i],!t.disabled&&t.name&&(r[t.name]=t.value);return r};Bob.binders={registerBinder:function(n,t,i){if(this.hasOwnProperty(n))throw"Binder name already exists '"+n+"'";else this[n]=t;return i&&i(),this},loadfile:function(n){var t=function(){return function(){this.read=function(n,t){var i=new FileReader;i.onload=function(n){return function(i){t(n,i.target.result)}}(n);i.readAsArrayBuffer(n)}}}();return{updateProperty:function(i){n.clearEventListeners("change");var r=function(n){var f=new t,r=n.target.files[0];for(var u in r)i.meta[u]=r[u];f.read(r,function(n,t){i.bytes=t})};n.addEventListener("change",r)}}},hide:function(n){return{updateProperty:function(t){typeof t=="function"&&(t=t());n.style.display=t?"":"none"}}},css:function(n){var t;return{updateProperty:function(i){(typeof i=="function"&&(i=i()),i)&&(t?t.split(",").forEach(function(t){n.classList.remove(t)}):i.split(",").forEach(function(t){n.classList.remove(t)}),n.classList.add(i),t=i)}}},keyup:function(n,t){return n.clearEventListeners("keyup"),n.addEventListener("keyup",function(){t(n.value)}),{updateProperty:function(){var t=arguments;typeof t[0]!="function"&&(n.value=t[0])}}},value:function(n,t){return n.clearEventListeners("keyup"),n.addEventListener("keyup",function(){t(n.value)}),{updateProperty:function(t){t!==n.value&&(n.value=t)}}},count:function(n){return{updateProperty:function(t){n.textContent=String(t).length}}},html:function(n){return{updateProperty:function(t){n.htmlText=t}}},href:function(n){return{updateProperty:function(t){n.setAttribute("href",t)}}},domId:function(n){return{updateProperty:function(t){n.setAttribute("id",t)}}},input:function(n){return{updateProperty:function(){n.clearEventListeners("input");var t=arguments,i=function(){t[0].apply(t[0](),[JSON.stringify(t[2])])};n.addEventListener("input",i)}}},dataset:function(n){return{updateProperty:function(t){n.dataset[t]=t}}},text:function(n){return{updateProperty:function(t){n.textContent=typeof t=="function"?t():t}}},selectchange:function(n,t,i,r){var u;return{updateProperty:function(){var t,f;n.clearEventListeners("change");t=arguments;u=t[5];f=function(n){for(var f=n.target.querySelectorAll("option"),t=0;t<f.length;t++)f[t].selected||r(u[t]);for(t=0;t<f.length;t++)f[t].selected&&i(u[t])};n.addEventListener("change",f)}}},select:function(n){return{updateProperty:function(){var t=arguments,r,u,i;if(Array.isArray(t[0]))r=t[0],u=r.findIndex(function(n){return JSON.stringify(n)==JSON.stringify(t[3])}),u>-1&&(n.selected=!0);else{if(i=t[0],t[3]){JSON.stringify(i)===JSON.stringify(t[3])&&(n.selected=!0);return}n.selected=i==n.value?!0:!1}}}},checkchange:function(n,t,i,r){var u,f;return{updateProperty:function(){var e=arguments,o;u=e[3];n.clearEventListeners("click");f||(f=typeof e[0]=="boolean");o=function(){f?t(n.checked):n.checked?i(u):r(u)};n.addEventListener("click",o)}}},checked:function(n){return{updateProperty:function(){var t=arguments;if(Array.isArray(t[0]))throw"Not yet implemented";else n.checked=t[0]}}},validate:function(){return{updateProperty:function(){}}},click:function(n){var t;return{updateProperty:function(i){function r(n){i.apply(t,[n])}n.clearEventListeners("click");t||(t=this);n.addEventListener("click",r)}}}};Bob.Notifier=function(){return function(){var n=[];this.name=undefined;this.on=function(t,i,r){return t.hasOwnProperty("$bob")?t.$bob:(t.$bob=new Bob.Dispatcher(i,r),n.push(t.$bob),t.$bob)};this.clone=function(t,i){i.$bob=n.findBy(function(n){return n.name===t}).first()};this.off=function(t,i){var r=n.findIndex(function(n){return n.name===t});n.splice(r,1);i&&i()}}}();Bob.Dispatcher=function(){var n=function(n,t,i){this.name=n;this.fn=i};return n.prototype.add=function(n){return this.$add=n,this},n.prototype.update=function(n){return this.$update=n,this},n.prototype.delete=function(n){return this.$delete=n,this},n}();Bob.apply=function(n){function t(n,r){if(r.indexOf("$this").length>0)return n;var f=r.split("."),u=getExpression(f[0]),e=new RegExp("^\\$root").test(u.prop);return e?t(i,f.slice(1).join("."),r):f.length==1?u.isFn?n[u.prop].apply(n,u.args[1].split(",")):typeof n[u.prop]=="object"?n[u.prop]:n:u.isFn?t(n[u.prop].apply(n,u.args[1].split(",")),f.slice(1).join("."),r):t(n[u.prop],f.slice(1).join("."),r)}function f(r,u,f,e){var o=t(f,e),h,s=e.split("|");e=s[0];s=s.slice(1);var v=function(n){if(o[e.split(".").pop()])o[e.split(".").pop()]=n;else if(Array.isArray(o)){var t=o.findIndex(function(t){return JSON.stringify(t)===JSON.stringify(n)});o.remove(t)}},y=function(n,t){var r,i;if(t||(t=e),o[t.split(".").pop()])throw"Not yet implemented";else if(Array.isArray(o))r=o.findIndex(function(t){return JSON.stringify(t)===JSON.stringify(n)}),r===-1&&o.push(n);else for(i in n)o[i]=n[i]},p=function(n,t){t||(t=e);t=t.split(".").pop();t=t.replace("(","").replace(")","");typeof o[t]=="function"?o[t].apply(o[t],[n]):o[t]=n;return},l=n[u](r,p,y,v,f),a=e.split(".").pop();r.dataset.with&&s.length===0?h=t(i,r.dataset.with):s.length>1&&(h=t(i,s[0]));l.updateProperty.apply(f,[o.hasOwnProperty(a)?o[a]:o,u,o,f,s,h||null]);var c=function(n){var i=o.$bob,c=n.some(function(n){return n.name===e.split(".").pop()}),t,r;c&&(t=n.first(),r=t.object,i&&(i.hasOwnProperty("$"+t.type)&&i["$"+t.type].apply(t.object,[r,t.name,t.type,t.oldValue,u]),i.fn&&i.fn.apply(i,[r,t.name,t.type,t.oldValue,u]),i.type=t.type),l.updateProperty(o[a],u,o,f,s,h));typeof o[a]!="function"||c||l.updateProperty(o[a],u,o,f,s,h)},w=function(){Object.observe(o,c)},b=function(){Object.unobserve(o,c)};return typeof o=="object"&&(Object.observe(o,c),Object.observe(o,function(n){n.forEach(function(t){var i=n.some(function(n){return n.key===e.split(".").pop()});t.type==="$update"&&i&&(Object.unobserve(o,c),l.updateProperty(t.$object[t.key],u,t.object,f,s,h),Object.observe(o,c))})},["$update"])),{propertyName:e,$binder:function(n,t){Object.unobserve(o,c);l.updateProperty(n,u,t,f,s,h);Object.observe(o,c)},observe:w,unobserve:b}}function s(n,t,i,r){n.setAttribute(t,i[r]);var f=function(i,r){n.setAttribute(t,r)},u=function(t){f(n,i[t[0].name])};return delete n.dataset.attr,Object.observe(i,u),{unobserve:function(){Object.unobserve(i,u)},observe:function(){Object.observe(i,u)}}}function h(n,t){function o(n){var t=n.previousSibling,i=n.parentNode,r=n.cloneNode(!0);return n.parentNode.removeChild(n),{insert:function(){var n=r.cloneNode(!0);return i.insertBefore(n,t),n}}}n.dataset.parent=n.dataset.repeat;delete n.dataset.repeat;var f=n.parentNode,s=o(n),e=function(n){var i=s.insert();return r(i,n,t)},u=t.map(function(n){return e(n)}),i=function(n){var i=t.$bob,o=n.findIndex(function(n){return n.type==="delete"});o>=0&&i&&i.hasOwnProperty("$delete")&&i.$delete.apply(n[0].oldValue,[n[0].oldValue,n[0].name,"delete"]);n.forEach(function(n){var o=parseInt(n.name,10),h,s;isNaN(o)||(s=isNaN(o)?n.object:n.object[o],s||(s=n.object),n.type==="add"?(i&&i.hasOwnProperty("$add")&&i["$"+n.type].apply(n.object,[s,n.name,n.type,n.oldvalue]),u.push(e(t[o]))):n.type==="update"?(u[o].unobserve(),r(f.children[o],t[o])):n.type==="delete"&&(h=f.children[o],h.parentNode.removeChild(h)))})},h=function(){Object.unobserve(t,i)},c=function(){Object.observe(t,i)};return Object.observe(t,i),Object.observe(t,function(n){n.forEach(function(n){var r,h,o,c,s;n.type==="$add"?(h=n.$object,Object.unobserve(t,i),r=t.push(h),u.push(e(t[r-1])),Object.observe(t,i)):n.type==="$delete"?(c=n.$object,r=t.findIndex(function(n){return JSON.stringify(n)===JSON.stringify(c)}),o=f.children[r],o.parentNode.removeChild(o),Object.unobserve(t,i),t.remove(r),Object.observe(t,i)):n.type==="$update"&&(r=t.findIndex(function(t){return t[n.key]===n.oldValue}),u[r]&&(s=u[r].bindings.findBy(function(t){if(t)return t.first().propertyName===n.key})),t[r][n.key]=n.$object[n.key],Object.observe(t,i),s&&s.forEach(function(t){var i=t.first().$binder;i.apply(n,[n.$object[n.key],n.$object])}))})},["$add","$delete","$update"]),{unobserve:h,observe:c}}function r(n,r){function a(n){for(n=n.parentElement;n;){if(n.dataset.repeat)return!1;n=n.parentElement}return!0}function l(t){var i=n.querySelectorAll(t);return Array.prototype.filter.call(i,a)}var o,u,c;for(typeof n=="string"&&(n=$(n)),o=typeof n=="object"?n.querySelectorAll("[data-template]"):$(n).querySelectorAll("[data-template]"),u=0;u<o.length;u++)e(o[u],o[u].dataset.template,r),delete o[u].dataset.template;return i||(i=r),c=l("[data-bind]").map(function(n){var t=n.dataset.bind;return t.split(",").map(function(i){var u=i.substr(0,i.indexOf(":")),e=i.substr(u.length+1,i.length);return f(n,u,r,e,t)})}).concat(l("[data-repeat]").map(function(n){var i=t(r,n.dataset.repeat);return h(n,i)})).concat([n].map(function(n){var t=n.dataset.bind;if(t)return t.split(",").forEach(function(i){var u=i.substr(0,i.indexOf(":")),e=i.substr(u.length+1,i.length);return f(n,u,r,e,t)})})).concat(l("[data-attr]").map(function(n){var t=n.dataset.attr;return t.split(",").map(function(t){var i=t.substr(0,t.indexOf(":")),u=t.substr(i.length+1,t.length);return s(n,i,r,u)})})),{bindings:c,unobserve:function(){c.forEach(function(n){n&&n.hasOwnProperty("unobserve")&&n.unobserve()})},observe:function(){c.forEach(function(n){n.observe()})}}}var e;n||(n=Bob.binders);var o=Bob.Guid.newGuid(),i,u=new Bob.Notifier;return e=function(n,t,i){window.fetch(t,{method:"get"}).then(function(n){return n.text()}).then(function(t){n.insertAdjacentHTML("afterbegin",t);r(n,i)})},{on:function(){return u.on.apply(this,arguments)},off:function(){return u.off.apply(this,arguments)},$instanceId:o,notifier:u,bind:r,$root:function(){return i}}};Array.prototype.intersect=function(n){for(var f=[],t=this.slice(0),i=n.slice(0),r=t.length-1,u=i.length-1;r>=0&&u>=0;)t[r]>i[u]?(t.pop(),r--):t[r]<i[u]?(i.pop(),u--):(f.push(t.pop()),i.pop(),r--,u--);return f};Array.prototype.first=function(n){return n?(n<0&&(n=0),this.slice(0,n)):this[0]};Array.prototype.take=function(n){return n||(n=2),this.filter(function(t,i){if(i<n)return t})||[]};Array.prototype.findBy=function(n){for(var i=this,r=[],t=0;t<i.length;t++)n(i[t])&&r.push(i[t]);return r};Array.prototype.count=function(n){var r=this,i=0,t;if(!n)return this.length;for(t=0;t<this.length;t++)n(r[t])&&i++;return i};Array.prototype.findIndex=function(n){for(var i=this,t=0;t<this.length;t++)if(n(i[t]))return t;return-1};Array.prototype.remove=function(n){return this.splice(n,1),this.length};Array.prototype.clone=function(){return this.slice(0)};Array.prototype.removeAll=function(){for(var n=0;this.length;n++)this.splice(n,1);return this.length};Object.defineProperties(Object,{extend:{configurable:!0,enumerable:!1,value:function(n,t){var i,r=Object.keys(t);return i=Object.keys(n).length?Object.clone(n):{},r.forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))}),i},writable:!0},clone:{configurable:!0,enumerable:!1,value:function(n){return Object.extend({},n)},writable:!0}});
//# sourceMappingURL=bob.core.latest.min.js.map
