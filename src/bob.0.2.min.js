var $=$||function(n,t){t||(t=document);var i=arguments;return i.length===0?t:typeof arguments[0]=="function"?(t.addEventListener("DOMContentLoaded",function(n){i[0].call(this,n)}),t):t.querySelector(n)},Bob=Bob||{},getExpression=function(n){var i=n.split(".").first(),r=i.match(/\((.*?)\)/),t;return r&&(i=i.replace(r[0],"")),t=i.replace(/[()]/g,""),t=t.replace(/\[(\w+)\]/g,".$1"),t=t.replace(/^\./,""),{prop:t,args:r,isFn:r===null?!1:!0}};Bob.serializeForm=function(n){n||(n=this);var r,i,f,t,u;for(r={},u=n.elements,i=0,f=u.length;i<f;i++)t=u[i],!t.disabled&&t.name&&(r[t.name]=t.value);return r};Bob.binders={registerBinder:function(n,t){return this.hasOwnProperty(n)&&(this[n]=t),this},hide:function(n){return{updateProperty:function(t){n.style.display=t?"":"none"}}},css:function(n){var t;return{updateProperty:function(i){(typeof i=="function"&&(i=i()),i)&&(t?t.split(",").forEach(function(t){n.classList.remove(t)}):i.split(",").forEach(function(t){n.classList.remove(t)}),n.classList.add(i),t=i)}}},value:function(n,t){return n.addEventListener("keyup",function(){t(n.value)}),{updateProperty:function(t){t!==n.value&&(n.value=t)}}},count:function(n){return{updateProperty:function(t){n.textContent=String(t).length}}},html:function(n){return{updateProperty:function(t){n.htmlText=t}}},text:function(n){return{updateProperty:function(t){n.textContent=t}}},selectchange:function(n,t,i,r){var u;return{updateProperty:function(){var f=arguments,t;u=f[5];t=function(n){for(var f=n.target.querySelectorAll("option"),t=0;t<f.length;t++)f[t].selected||r(u[t]);for(t=0;t<f.length;t++)f[t].selected&&i(u[t])};n.addEventListener("change",t)}}},select:function(n){return{updateProperty:function(){var t=arguments,r,u,i;if(Array.isArray(t[0]))r=t[0],u=r.findIndex(function(n){return JSON.stringify(n)==JSON.stringify(t[3])}),u>-1&&(n.selected=!0);else{if(i=t[0],t[3]){JSON.stringify(i)===JSON.stringify(t[3])&&(n.selected=!0);return}n.selected=i==n.value?!0:!1}}}},checkchange:function(n,t,i,r){var u,f,e;return{updateProperty:function(){var s=arguments,o;f=s[3];e||(e=typeof s[0]=="boolean");o=function(){e?t(n.checked):n.checked?i(f):r(f)};u&&n.removeEventListener("click",u);u=o;n.addEventListener("click",o)}}},checked:function(n){return{updateProperty:function(){var t=arguments;if(Array.isArray(t[0]))throw"Not yet implemented";else n.checked=t[0]}}},click:function(n){var t,i;return{updateProperty:function(r){i||(i=this);var u=function(n){r.apply(i,[n])};t&&n.removeEventListener("click",t);t=u;n.addEventListener("click",u)}}}};Bob.Notifier=function(){return function(){var n=this;this.notifiers=[];this.on=function(t,i,r){var u,f=n.notifiers.findBy(function(n){return n.name==t});return f.length==0&&(u={name:t,fn:i,ts:new Date}),n.notifiers.push(u),r&&r.apply(u,[u]),this};this.off=function(t){var i=n.notifiers.findBy(function(n){return n.name==t})}}}();Bob.apply=function(n){function t(n,r){if(r==="$this")return n;var f=r.split("."),u=getExpression(f[0]),e=new RegExp("^\\$root").test(u.prop);return e?t(i,f.slice(1).join("."),r):f.length==1?u.isFn?n[u.prop].apply(n,u.args[1].split(",")):Array.isArray(n[u.prop])?n[u.prop]:typeof n[u.prop]=="object"?n[u.prop]:n:u.isFn?t(n[u.prop].apply(n,u.args[1].split(",")),f.slice(1).join("."),r):t(n[u.prop],f.slice(1).join("."),r)}function f(r,u,f,o){var s=t(f,o),l,h,y,a;r.dataset.attr&&e(r,s);h=o.split("|");o=h[0];h=h.slice(1);var p=function(n){if(s[o.split(".").pop()])s[o.split(".").pop()]=n;else if(Array.isArray(s)){var t=s.findIndex(function(t){return JSON.stringify(t)===JSON.stringify(n)});s.remove(t)}},w=function(n,t){var r,i;if(t||(t=o),s[t.split(".").pop()])throw"Not yet implemented";else if(Array.isArray(s))r=s.findIndex(function(t){return JSON.stringify(t)===JSON.stringify(n)}),r===-1&&s.push(n);else for(i in n)s[i]=n[i]},b=function(n,t){t||(t=o);s[t.split(".").pop()]=n;return},v=n[u](r,b,w,p,f),c=o.split(".").pop();c=c.replace("(","").replace(")","");r.dataset.with&&h.length===0?l=t(i,r.dataset.with):h.length>1&&(l=t(i,h[0]));y=s.hasOwnProperty(c)?s[c]:s;v.updateProperty.apply(f,[y,u,s,f,h,l]);a=function(n){var t=n.some(function(n){return n.name===o.split(".").pop()});t&&v.updateProperty(s[c],u,s,f,h,l);typeof s[c]!="function"||t||v.updateProperty(s[c],u,s,f,h,l)};try{Object.observe(s,a)}catch(k){}return{unobserve:function(){Object.unobserve(s,a)},observe:function(){Object.observe(s,a)}}}function e(n,t){var u,f,i;if(typeof t=="object")return u=function(i){var u=n.dataset.attr.split(",");return u.forEach(function(n){var r=n.split(":");switch(r[0]){case"innerText":i.textContent=t[r[1]];break;default:i.setAttribute(r[0],t[r[1]])}}),r(n,t)},f=function(i,u){var f=n.dataset.attr.split(",");return f.forEach(function(n){var f=n.split(":"),r,e;f[0]==="text"?i.textContent=u[f[1]]:(r=f[1].split(".").pop(),r&&(r=r.replace("(","").replace(")","")),e=typeof t[r]=="function",i.setAttribute(f[0],e?t[r]():t[f[1].split(".").pop()]))}),r(n,u)},u(n),i=function(t){f(n,t[0].object)},Object.observe(t,i),{unobserve:function(){Object.unobserve(t,i)},observe:function(){Object.observe(t,i)}}}function s(n,t){function s(n){var t=n.previousSibling,i=n.parentNode,r=n.cloneNode(!0);return n.parentNode.removeChild(n),{insert:function(){var n=r.cloneNode(!0);return i.insertBefore(n,t),n}}}n.dataset.parent=n.dataset.repeat;delete n.dataset.repeat;var f=n.parentNode,h=s(n),o=function(i){var u=h.insert(),f=r(u,i,t);return n.dataset.attr&&e(u,i),f},i=t.map(function(n){return o(n)}),u=function(n){n.forEach(function(n){var u=parseInt(n.name,10),e;isNaN(u)||(n.type==="add"?i.push(o(t[u])):n.type==="update"?(i[u].unobserve(),r(f.children[u],t[u])):n.type==="delete"&&(i.pop().unobserve(),e=f.children[u],e.parentNode.removeChild(e)))})};return Object.observe(t,u),{unobserve:function(){Object.unobserve(t,u)},observe:function(){Object.observe(object,u)}}}function r(n,r,e){function a(n){for(n=n.parentElement;n;){if(n.dataset.repeat)return!1;n=n.parentElement}return!0}function c(t){var i=n.querySelectorAll(t);return Array.prototype.filter.call(i,a)}var l,h;return u&&(l=u.notifiers.map(function(n){if(o.findBy(function(t){return t===n.name}).length===0){var i=t(r,n.name);Object.observe(i,function(t){t.forEach(function(t){n.ts=new Date;n.fn.apply(n,[t])})});o.push(n.name)}return n.name})),i||(i=r),h=c("[data-bind]").map(function(n){var t=n.dataset.bind;t.split(",").forEach(function(t){var i=t.substr(0,t.indexOf(":")),u=t.substr(i.length+1,t.length);f(n,i,r,u)})}).concat(c("[data-repeat]").map(function(n){return s(n,t(r,n.dataset.repeat))})).concat([n].map(function(n){var t=n.dataset.bind;t&&t.split(",").forEach(function(t){var i=t.substr(0,t.indexOf(":")),u=t.substr(i.length+1,t.length);f(n,i,r,u,e)})})),{unobserve:function(){h.forEach(function(n){n&&n.unobserve()})},observe:function(){h.forEach(function(n){n.observe()})}}}var i,u=new Bob.Notifier,o=[];return{notifier:u,bind:r,$root:function(){return i}}};Array.prototype.intersect=function(n){for(var f=[],t=this.slice(0),i=n.slice(0),r=t.length-1,u=i.length-1;r>=0&&u>=0;)t[r]>i[u]?(t.pop(),r--):t[r]<i[u]?(i.pop(),u--):(f.push(t.pop()),i.pop(),r--,u--);return f};Array.prototype.first=function(n){return n?(n<0&&(n=0),this.slice(0,n)):this[0]};Array.prototype.take=function(n){return n||(n=2),this.filter(function(t,i){if(i<n)return t})||[]};Array.prototype.findBy=function(n){for(var i=this,r=[],t=0;t<i.length;t++)n(i[t])&&r.push(i[t]);return r};Array.prototype.count=function(n){var r=this,i=0,t;if(!n)return this.length;for(t=0;t<this.length;t++)n(r[t])&&i++;return i};Array.prototype.findIndex=function(n){for(var i=this,t=0;t<this.length;t++)if(n(i[t]))return t;return-1};Array.prototype.remove=function(n){return this.splice(n,1),this.length};Array.prototype.clone=function(){return this.slice(0)};Array.prototype.removeAll=function(){for(var n=0;this.length;n++)this.splice(n,1);return this.length};
//# sourceMappingURL=bob.0.2.min.js.map
