var $=$||function(n,t){t||(t=document);var i=arguments;return i.length===0?t:typeof arguments[0]=="function"?(t.addEventListener("DOMContentLoaded",function(n){i[0].call(this,n)}),t):t.querySelector(n)},Bob=Bob||{},getExpression=function(n){var i=n.split(".").first(),r=i.match(/\((.*?)\)/),t;return r&&(i=i.replace(r[0],"")),t=i.replace(/[()]/g,""),t=t.replace(/\[(\w+)\]/g,".$1"),t=t.replace(/^\./,""),{prop:t,args:r,isFn:r===null?!1:!0}};Bob.serializeForm=function(n){n||(n=this);var r,i,f,t,u;for(r={},u=n.elements,i=0,f=u.length;i<f;i++)t=u[i],!t.disabled&&t.name&&(r[t.name]=t.value);return r};Bob.binders={registerBinder:function(n,t){return this.hasOwnProperty(n)&&(this[n]=t),this},hide:function(n){return{updateProperty:function(t){n.style.display=t?"":"none"}}},css:function(n){var t;return{updateProperty:function(i){(typeof i=="function"&&(i=i()),i)&&(t?t.split(",").forEach(function(t){n.classList.remove(t)}):i.split(",").forEach(function(t){n.classList.remove(t)}),n.classList.add(i),t=i)}}},value:function(n,t){return n.addEventListener("keyup",function(){t(n.value)}),{updateProperty:function(t){t!==n.value&&(n.value=t)}}},count:function(n){return{updateProperty:function(t){n.textContent=String(t).length}}},html:function(n){return{updateProperty:function(t){n.htmlText=t}}},text:function(n){return{updateProperty:function(t){n.textContent=t}}},selectchange:function(n,t){return{updateProperty:function(i,r,u){var f=function(i){for(var f=i.target.querySelectorAll("option:checked"),e=[],r=0;r<f.length;r++)e.push(u[f[r].index]);t(e,n.dataset.with)};n.addEventListener("change",f)}}},select:function(n){return{updateProperty:function(){var t=arguments,i,r,u;if(Array.isArray(t[2]))i=t[2],r=i.findIndex(function(n){return JSON.stringify(n)==JSON.stringify(t[3])}),r||(n.selected=!0);else{if(u=t[0],!n.value)return;n.selected=u==n.value?!0:!1}}}},checkchange:function(n,t){var i;return{updateProperty:function(){var r=arguments,u=function(){typeof r[0]=="boolean"?t(n.checked,n.dataset.wite):t(r[0],n.dataset.with,n.checked)};i&&n.removeEventListener("click",i);i=u;n.addEventListener("change",u)}}},checked:function(n){return{updateProperty:function(){var t=arguments,i;if(typeof t[0]=="object"){i=t[3];i.forEach(function(i){n.checked=JSON.stringify(i)===JSON.stringify(t[0])});return}n.checked=t[0]?!0:!1}}},click:function(n){var t,i;return{updateProperty:function(r){i||(i=this);var u=function(n){r.apply(i,[n])};t&&n.removeEventListener("click",t);t=u;n.addEventListener("click",u)}}}};Bob.Notifier=function(){return function(){var n=this;this.notifiers=[];this.on=function(t,i,r){var u,f=n.notifiers.findBy(function(n){return n.name==t});return f.length==0&&(u={name:t,fn:i,ts:new Date}),n.notifiers.push(u),r&&r.apply(u,[u]),this};this.off=function(t){var i=n.notifiers.findBy(function(n){return n.name==t})}}}();Bob.apply=function(n){function t(n,r){if(r==="$this")return n;var f=r.split("."),u=getExpression(f[0]),e=new RegExp("^\\$root").test(u.prop);return e?t(i,f.slice(1).join("."),r):f.length==1?u.isFn?n[u.prop].apply(n,u.args[1].split(",")):Array.isArray(n[u.prop])?n[u.prop]:typeof n[u.prop]=="object"?n[u.prop]:n:u.isFn?t(n[u.prop].apply(n,u.args[1].split(",")),f.slice(1).join("."),r):t(n[u.prop],f.slice(1).join("."),r)}function f(r,u,f,o){var s=t(f,o),a,v,c;r.dataset.attr&&e(r,s);var y=function(n,i){var e=arguments,r,h,u;if(i||(i=o),!s.hasOwnProperty(i.split(".").pop())){r=t(f,i);Array.isArray(n)&&Array.isArray(r)?(h=r.intersect(n),h.map(function(n){var t=r.findIndex(function(t){return JSON.stringify(t)===JSON.stringify(n)});t>-1;r.remove(t)}),n.map(function(n){var t=r.findIndex(function(t){return JSON.stringify(t)===JSON.stringify(n)});t>-1||r.push(n)})):Array.isArray(n)&&!Array.isArray(r)?r[i.split(".").pop()]=n[0][i.split(".").pop()]:!Array.isArray(n)&&Array.isArray(r)?typeof e[2]=="boolean"&&(u=r.findIndex(function(t){return JSON.stringify(t)===JSON.stringify(n)}),e[2]?u==-1&&r.push(n):r.remove(u)):s[i.split(".").pop()]=n;return}s[i.split(".").pop()]=n},l=n[u](r,y,f),h=o.split(".").pop();h=h.replace("(","").replace(")","");r.dataset.with&&(a=t(i,r.dataset.with));v=s.hasOwnProperty(h)?s[h]:s;l.updateProperty.apply(f,[v,u,s,a||f]);c=function(n){var t=n.some(function(n){return n.name===o.split(".").pop()});t&&l.updateProperty(s[h],u,s);typeof s[h]!="function"||t||l.updateProperty(s[h],u,s)};try{Object.observe(s,c)}catch(p){}return{unobserve:function(){Object.unobserve(s,c)},observe:function(){Object.observe(s,c)}}}function e(n,u){var e,o,f;if(typeof u=="object")return e=function(f){var e=n.dataset.attr.split(",");return e.forEach(function(r){var e=r.split(":"),o;switch(e[0]){case"innerText":f.textContent=u[e[1]];break;case"selected":o=t(i,e[1]);Array.isArray(o)?o.forEach(function(t){JSON.stringify(t)===JSON.stringify(u)&&(n.selected=!0)}):o==n.value&&(n.selected=!0);break;default:f.setAttribute(e[0],u[e[1]])}}),r(n,u)},o=function(t,i){var f=n.dataset.attr.split(",");return f.forEach(function(n){var f=n.split(":"),r,e;f[0]==="text"?t.textContent=i[f[1]]:(r=f[1].split(".").pop(),r&&(r=r.replace("(","").replace(")","")),e=typeof u[r]=="function",t.setAttribute(f[0],e?u[r]():u[f[1].split(".").pop()]))}),r(n,i)},e(n),f=function(t){o(n,t[0].object)},Object.observe(u,f),{unobserve:function(){Object.unobserve(u,f)},observe:function(){Object.observe(u,f)}}}function s(n,t){var i=function(t){var i=t.cloneNode(!0);return t.parentNode.removeChild(t),{insert:function(){var t=i.cloneNode(!0);return n.appendChild(t),t}}};delete n.dataset.options;var u=function(n){var i=f.insert();return r(i,n,t)},f=i(n.firstElementChild),o=t.map(function(n){return u(n)}),e=function(){};Object.observe(t,e)}function h(n,t){function s(n){var t=n.previousSibling,i=n.parentNode,r=n.cloneNode(!0);return n.parentNode.removeChild(n),{insert:function(){var n=r.cloneNode(!0);return i.insertBefore(n,t),n}}}n.dataset.parent=n.dataset.repeat;delete n.dataset.repeat;var f=n.parentNode,h=s(n),o=function(i){var u=h.insert(),f=r(u,i,t);return n.dataset.attr&&e(u,i),f},i=t.map(function(n){return o(n)}),u=function(n){n.forEach(function(n){var u=parseInt(n.name,10),e;isNaN(u)||(n.type==="add"?i.push(o(t[u])):n.type==="update"?(i[u].unobserve(),r(f.children[u],t[u])):n.type==="delete"&&(i.pop().unobserve(),e=f.children[u],e.parentNode.removeChild(e)))})};return Object.observe(t,u),{unobserve:function(){Object.unobserve(t,u)},observe:function(){Object.observe(object,u)}}}function r(n,r){function a(n){for(n=n.parentElement;n;){if(n.dataset.repeat)return!1;n=n.parentElement}return!0}function e(t){var i=n.querySelectorAll(t);return Array.prototype.filter.call(i,a)}var l,c;return u&&(l=u.notifiers.map(function(n){if(o.findBy(function(t){return t===n.name}).length===0){var i=t(r,n.name);Object.observe(i,function(t){t.forEach(function(t){n.ts=new Date;n.fn.apply(n,[t])})});o.push(n.name)}return n.name})),i||(i=r),c=e("[data-bind]").map(function(n){var t=n.dataset.bind;t.split(",").forEach(function(t){var i=t.substr(0,t.indexOf(":")),u=t.substr(i.length+1,t.length);f(n,i,r,u)})}).concat(e("[data-repeat]").map(function(n){var i=t(r,n.dataset.repeat);return h(n,i)})).concat(e("[data-options]").map(function(n){var i=t(r,n.dataset.options);return s(n,i)})).concat([n].map(function(n){var t=n.dataset.bind;t&&t.split(",").forEach(function(t){var i=t.substr(0,t.indexOf(":")),u=t.substr(i.length+1,t.length);f(n,i,r,u)})})),{unobserve:function(){c.forEach(function(n){n&&n.unobserve()})},observe:function(){c.forEach(function(n){n.observe()})}}}var i,u=new Bob.Notifier,o=[];return{notifier:u,bind:r,$root:function(){return i}}};Array.prototype.intersect=function(n){for(var f=[],t=this.slice(0),i=n.slice(0),r=t.length-1,u=i.length-1;r>=0&&u>=0;)t[r]>i[u]?(t.pop(),r--):t[r]<i[u]?(i.pop(),u--):(f.push(t.pop()),i.pop(),r--,u--);return f};Array.prototype.first=function(n){return n?(n<0&&(n=0),this.slice(0,n)):this[0]};Array.prototype.take=function(n){return n||(n=2),this.filter(function(t,i){if(i<n)return t})||[]};Array.prototype.findBy=function(n){for(var i=this,r=[],t=0;t<i.length;t++)n(i[t])&&r.push(i[t]);return r};Array.prototype.count=function(n){var r=this,i=0,t;if(!n)return this.length;for(t=0;t<this.length;t++)n(r[t])&&i++;return i};Array.prototype.findIndex=function(n){for(var i=this,t=0;t<this.length;t++)if(n(i[t]))return t;return-1};Array.prototype.remove=function(n){return this.splice(n,1),this.length};Array.prototype.clone=function(){return this.slice(0)};Array.prototype.removeAll=function(){for(var n=0;this.length;n++)this.splice(n,1);return this.length};
//# sourceMappingURL=bob.0.1.min.js.map
